import { useEffect,useRef } from 'react'; import { VisualizerMode } from './visualizerModes'; export function VisualizerCanvas({ analyser, mode, color }:{ analyser:AnalyserNode|null; mode:VisualizerMode; color:string }){const ref=useRef<HTMLCanvasElement>(null);useEffect(()=>{if(!analyser||!ref.current)return;const c=ref.current;const ctx=c.getContext('2d')!;const data=new Uint8Array(analyser.frequencyBinCount);const draw=()=>{analyser.getByteFrequencyData(data);ctx.clearRect(0,0,c.width,c.height);if(mode==='bars'){const bars=64;const w=c.width/bars;for(let i=0;i<bars;i++){const v=data[Math.floor(i/bars*data.length)]/255;ctx.fillStyle=color;ctx.fillRect(i*w,c.height-v*c.height,w-2,v*c.height);}}requestAnimationFrame(draw);};draw();},[analyser,mode,color]);return <canvas ref={ref} width={1280} height={720}/>;}